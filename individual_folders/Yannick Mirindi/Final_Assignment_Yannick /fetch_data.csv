import requests
import json
import datetime
import csv

# Function to fetch data from OpenWeatherMap API
def fetch_data_openweathermap(api_url, latitude, longitude, api_key):
    # Set the date for which you want the data (e.g., 7 days ago)
    date = datetime.datetime.now() - datetime.timedelta(days=7)
    timestamp = int(date.timestamp())
    
    params = {
        "lat": latitude,
        "lon": longitude,
        "dt": timestamp,
        "appid": api_key
    }
    
    response = requests.get(api_url, params=params)
    if response.status_code == 200:
        return response.json()
    else:
        print(f"Error: Unable to fetch data from OpenWeatherMap (Status code: {response.status_code})")
        return None

